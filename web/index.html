<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>TV Remote</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: #1a1a2e;
        color: #eee;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      /* -- Header -- */
      header {
        width: 100%;
        max-width: 400px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 12px 8px;
      }
      header h1 {
        font-size: 1.2rem;
        font-weight: 600;
      }
      #settings-link {
        color: #aaa;
        text-decoration: none;
        font-size: 1.4rem;
        padding: 4px 8px;
      }
      #settings-link:hover {
        color: #fff;
      }

      /* -- Pages -- */
      .page {
        display: none;
        width: 100%;
        max-width: 400px;
        padding: 8px 12px;
      }
      .page.active {
        display: block;
      }

      /* -- Remote control layout -- */
      .remote {
        display: flex;
        flex-direction: column;
        gap: 12px;
        align-items: center;
      }

      .btn-row {
        display: flex;
        gap: 8px;
        justify-content: center;
        flex-wrap: wrap;
      }

      button {
        background: #2d2d44;
        color: #eee;
        border: 1px solid #444;
        border-radius: 8px;
        font-size: 0.85rem;
        cursor: pointer;
        padding: 12px 16px;
        min-width: 56px;
        text-align: center;
        user-select: none;
        -webkit-user-select: none;
        touch-action: manipulation;
        transition: background 0.1s;
      }
      button:active {
        background: #4a4a6a;
      }

      button.power {
        background: #7f1d1d;
        border-color: #991b1b;
      }
      button.power:active {
        background: #b91c1c;
      }

      button.ok-btn {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        background: #3b3b5c;
        font-size: 1rem;
        font-weight: bold;
      }

      button.nav {
        width: 56px;
        height: 56px;
        font-size: 1.2rem;
        border-radius: 12px;
      }

      /* D-pad grid */
      .dpad {
        display: grid;
        grid-template-columns: 56px 64px 56px;
        grid-template-rows: 56px 64px 56px;
        gap: 4px;
        justify-items: center;
        align-items: center;
      }
      .dpad .up {
        grid-column: 2;
        grid-row: 1;
      }
      .dpad .left {
        grid-column: 1;
        grid-row: 2;
      }
      .dpad .ok {
        grid-column: 2;
        grid-row: 2;
      }
      .dpad .right {
        grid-column: 3;
        grid-row: 2;
      }
      .dpad .down {
        grid-column: 2;
        grid-row: 3;
      }
      .dpad .back {
        grid-column: 1;
        grid-row: 3;
      }
      .dpad .menu {
        grid-column: 3;
        grid-row: 3;
      }

      /* Volume/channel strip */
      .vol-ch {
        display: flex;
        gap: 24px;
        align-items: center;
      }
      .vol-ch .group {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
      }
      .vol-ch .group label {
        font-size: 0.7rem;
        color: #888;
        text-transform: uppercase;
      }

      /* Number pad */
      .numpad {
        display: grid;
        grid-template-columns: repeat(3, 56px);
        gap: 6px;
        justify-content: center;
      }
      .numpad button {
        padding: 10px;
      }

      /* Media row */
      .media-row button {
        font-size: 1rem;
      }
      .media-toggle {
        font-size: 0.75rem !important;
        font-weight: 700;
        min-width: 40px;
        padding: 8px;
        background: #242438;
        border: none;
        color: #888;
        overflow: hidden;
      }
      .media-toggle img {
        width: 24px;
        height: 24px;
        border-radius: 4px;
        display: block;
      }
      .media-toggle:active {
        background: #2d2d44;
      }
      .media-btn:disabled {
        opacity: 0.3;
        cursor: default;
      }
      .media-tracks-btn {
        font-size: 0.75rem !important;
        font-weight: 700;
        min-width: 40px;
        padding: 8px;
        background: #242438;
        border: none;
        color: #888;
      }
      .media-tracks-btn:active {
        background: #2d2d44;
      }
      .media-tracks-btn:disabled {
        opacity: 0.3;
        cursor: default;
      }
      .tracks-dropdown {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #1a1a2e;
        border: 1px solid #333;
        border-radius: 8px;
        padding: 12px;
        min-width: 200px;
        z-index: 101;
      }
      .tracks-dropdown.open {
        display: block;
      }
      .tracks-dropdown-backdrop {
        display: none;
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        z-index: 100;
      }
      .tracks-dropdown-backdrop.open {
        display: block;
      }
      .tracks-group-label {
        font-size: 0.65rem;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 6px;
      }
      .tracks-group-label:not(:first-child) {
        margin-top: 10px;
      }
      .tracks-segments {
        display: flex;
        gap: 0;
        border-radius: 6px;
        overflow: hidden;
        border: 1px solid #333;
      }
      .tracks-segments button {
        flex: 1;
        padding: 6px 10px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        background: #242438;
        color: #888;
        border: none;
        border-right: 1px solid #333;
        cursor: pointer;
        min-width: 0;
      }
      .tracks-segments button:last-child {
        border-right: none;
      }
      .tracks-segments button.active {
        background: #2d2d6a;
        color: #ccc;
      }
      .tracks-segments button:active {
        background: #3d3d5c;
      }
      .media-title {
        font-size: 0.7rem;
        color: #888;
        text-align: center;
        width: 80%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .media-title:empty {
        display: none;
      }
      .media-progress {
        width: 80%;
        height: 5px;
        background: #333;
      }
      .media-progress-bar {
        height: 100%;
        background: #888;
        width: 0%;
        transition: width 0.3s ease;
      }

      /* Separator */
      .sep {
        width: 80%;
        height: 1px;
        background: #333;
      }

      /* -- Settings page -- */
      .settings {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .settings h2 {
        font-size: 1.1rem;
        margin-bottom: 4px;
      }

      .settings label {
        font-size: 0.85rem;
        color: #aaa;
      }

      .settings input[type="text"] {
        background: #2d2d44;
        border: 1px solid #555;
        border-radius: 6px;
        color: #eee;
        padding: 10px 12px;
        font-size: 1rem;
        width: 100%;
      }

      .settings .field {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .settings .row {
        display: flex;
        gap: 8px;
      }
      .settings .row input {
        flex: 1;
      }
      .settings .row button {
        white-space: nowrap;
      }

      .back-link {
        color: #aaa;
        text-decoration: none;
        font-size: 0.9rem;
      }
      .back-link:hover {
        color: #fff;
      }

      #tv-ip-display {
        font-size: 0.85rem;
        color: #888;
      }

      .saved-tv {
        display: flex;
        align-items: center;
        gap: 6px;
        margin-top: 8px;
        padding: 8px;
        background: #2d2d44;
        border: 1px solid #444;
        border-radius: 8px;
      }
      .saved-tv.active {
        border-color: #fff;
      }
      .saved-tv .tv-info {
        flex: 1;
        min-width: 0;
      }
      .saved-tv .tv-name {
        font-size: 0.9rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .saved-tv .tv-ip {
        font-size: 0.75rem;
        color: #888;
      }
      .saved-tv button {
        padding: 6px 10px;
        min-width: auto;
        font-size: 0.75rem;
      }
      .saved-tv button:disabled {
        border: none;
        opacity: 0.6;
        cursor: default;
      }
      .saved-tv .del-btn {
        background: #7f1d1d;
        border-color: #991b1b;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 6px;
      }
      .saved-tv .del-btn:active {
        background: #b91c1c;
      }

      .saved-tv-name-edit {
        background: #2d2d44;
        border: 1px solid #555;
        border-radius: 4px;
        color: #eee;
        padding: 4px 6px;
        font-size: 0.85rem;
        width: 100%;
      }

      .device-list:empty::after {
        color: #666;
        font-size: 0.85rem;
      }
      #saved-tvs:empty::after {
        content: "No TVs saved yet.";
      }
      #saved-chromecasts:empty::after {
        content: "No Chromecasts saved yet.";
      }

      .settings-section {
        border: 1px solid #333;
        border-radius: 10px;
        padding: 12px;
      }
      .settings-section h2 {
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 10px;
        color: #ccc;
      }

      .discover-btn {
        background: #1e3a5f;
        border-color: #2563eb;
        padding: 12px;
      }
      .discover-btn:active {
        background: #2563eb;
      }

      .discover-status {
        font-size: 0.85rem;
        color: #888;
        min-height: 1.4em;
      }
    </style>
  </head>
  <body>
    <!-- CONTROL PAGE -->
    <div id="page-control" class="page active">
      <header>
        <button class="power" data-key="TR_KEY_POWER" style="padding: 8px 10px">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            width="20"
            height="20"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"
            />
          </svg>
        </button>
        <h1 id="tv-ip-display"></h1>
        <a href="#" id="settings-link" title="Settings">&#9881;</a>
      </header>

      <div class="remote">
        <!-- D-Pad -->
        <div class="dpad">
          <button class="nav up" data-key="TR_KEY_UP">&#9650;</button>
          <button class="nav left" data-key="TR_KEY_LEFT">&#9664;</button>
          <button class="nav ok-btn ok" data-key="TR_KEY_OK">OK</button>
          <button class="nav right" data-key="TR_KEY_RIGHT">&#9654;</button>
          <button class="nav down" data-key="TR_KEY_DOWN">&#9660;</button>
          <button class="nav back" data-key="TR_KEY_BACK">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              width="20"
              height="20"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"
              />
            </svg>
          </button>
          <button class="nav menu" data-key="TR_KEY_MAINMENU">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              width="20"
              height="20"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"
              />
            </svg>
          </button>
        </div>

        <div class="sep"></div>

        <!-- Volume / Channel -->
        <div class="vol-ch">
          <button data-key="TR_KEY_MUTE">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              width="20"
              height="20"
              style="vertical-align: middle"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"
              />
            </svg>
          </button>
          <div class="group">
            <label>Vol</label>
            <button data-key="TR_KEY_VOL_UP">+</button>
            <button data-key="TR_KEY_VOL_DOWN">&minus;</button>
          </div>
          <div class="group">
            <label>Ch</label>
            <button data-key="TR_KEY_CH_UP">&#9650;</button>
            <button data-key="TR_KEY_CH_DOWN">&#9660;</button>
          </div>
        </div>

        <div class="sep"></div>

        <!-- Media controls with TV/CC toggle -->
        <div class="btn-row media-row">
          <button id="media-toggle" class="media-toggle">CC</button>
          <button id="media-rew" class="media-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 16.811c0 .864-.933 1.406-1.683.977l-7.108-4.061a1.125 1.125 0 0 1 0-1.954l7.108-4.061A1.125 1.125 0 0 1 21 8.689v8.122ZM11.25 16.811c0 .864-.933 1.406-1.683.977l-7.108-4.061a1.125 1.125 0 0 1 0-1.954l7.108-4.061a1.125 1.125 0 0 1 1.683.977v8.122Z"/></svg></button>
          <button id="media-playpause" class="media-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5V18M15 7.5V18M3 16.811V8.69c0-.864.933-1.406 1.683-.977l7.108 4.061a1.125 1.125 0 0 1 0 1.954l-7.108 4.061A1.125 1.125 0 0 1 3 16.811Z"/></svg></button>
          <button id="media-ff" class="media-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M3 8.689c0-.864.933-1.406 1.683-.977l7.108 4.061a1.125 1.125 0 0 1 0 1.954l-7.108 4.061A1.125 1.125 0 0 1 3 16.811V8.69ZM12.75 8.689c0-.864.933-1.406 1.683-.977l7.108 4.061a1.125 1.125 0 0 1 0 1.954l-7.108 4.061a1.125 1.125 0 0 1-1.683-.977V8.69Z"/></svg></button>
          <button id="media-tracks-btn" class="media-tracks-btn" disabled><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 21L15.75 9.75L21 21M12 18H19.5M3 5.62136C4.96557 5.37626 6.96804 5.25 9 5.25M9 5.25C10.1208 5.25 11.2326 5.28841 12.3343 5.364M9 5.25V3M12.3343 5.364C11.1763 10.6578 7.68868 15.0801 3 17.5023M12.3343 5.364C13.2298 5.42545 14.1186 5.51146 15 5.62136M10.4113 14.1162C8.78554 12.4619 7.47704 10.4949 6.58432 8.31366"/></svg></button>
        </div>
        <div id="tracks-backdrop" class="tracks-dropdown-backdrop"></div>
        <div id="tracks-dropdown" class="tracks-dropdown"></div>
        <div id="media-title" class="media-title"></div>
        <div class="media-progress">
          <div id="media-progress-bar" class="media-progress-bar"></div>
        </div>

        <!-- Quick access -->
        <div class="btn-row">
          <button data-key="TR_KEY_HOME">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              width="20"
              height="20"
              style="vertical-align: middle"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"
              />
            </svg>
          </button>
          <button data-key="TR_KEY_SMARTTV">Smart TV</button>
          <button data-key="TR_KEY_GUIDE">Guide</button>
        </div>

        <!-- Number pad -->
        <div class="numpad">
          <button data-key="TR_KEY_1">1</button>
          <button data-key="TR_KEY_2">2</button>
          <button data-key="TR_KEY_3">3</button>
          <button data-key="TR_KEY_4">4</button>
          <button data-key="TR_KEY_5">5</button>
          <button data-key="TR_KEY_6">6</button>
          <button data-key="TR_KEY_7">7</button>
          <button data-key="TR_KEY_8">8</button>
          <button data-key="TR_KEY_9">9</button>
          <button></button>
          <button data-key="TR_KEY_0">0</button>
          <button></button>
        </div>
      </div>
    </div>

    <!-- SETTINGS PAGE -->
    <div id="page-settings" class="page">
      <header>
        <a href="#" id="back-link" class="back-link">&#8592; Back</a>
        <h1>Settings</h1>
        <span></span>
      </header>

      <div class="settings">
        <div class="settings-section">
          <h2>TV sets</h2>
          <div id="saved-tvs" class="device-list"></div>
          <div class="field" style="margin-top: 10px">
            <div class="row">
              <input type="text" id="ip-input" placeholder="IP address" />
              <input type="text" id="name-input" placeholder="Nickname" />
              <button id="save-ip-btn">Add</button>
            </div>
          </div>
          <div class="field" style="margin-top: 8px">
            <button id="discover-tv-btn" class="discover-btn">
              Search for TVs
            </button>
            <div id="discover-tv-status" class="discover-status"></div>
            <div id="discover-tv-results"></div>
          </div>
        </div>

        <div class="settings-section">
          <h2>Chromecasts</h2>
          <div id="saved-chromecasts" class="device-list"></div>
          <div class="field" style="margin-top: 10px">
            <div class="row">
              <input type="text" id="cc-ip-input" placeholder="IP address" />
              <input type="text" id="cc-name-input" placeholder="Nickname" />
              <button id="save-cc-btn">Add</button>
            </div>
          </div>
          <div class="field" style="margin-top: 8px">
            <button id="discover-cc-btn" class="discover-btn">
              Search for Chromecasts
            </button>
            <div id="discover-cc-status" class="discover-status"></div>
            <div id="discover-cc-results"></div>
          </div>
        </div>
      </div>
    </div>

    <script src="tvcontrol.js"></script>
  </body>
</html>
